2024-06-14 10:37:24 | INFO | model_worker | args: Namespace(host='localhost', port=21002, worker_address='http://localhost:21002', controller_address='http://localhost:21001', model_path='/home/c205/workspace/models/Qwen-7B-QAnything/', revision='main', device='cuda', gpus=None, num_gpus=1, max_gpu_memory=None, dtype=None, load_8bit=False, cpu_offloading=False, gptq_ckpt=None, gptq_wbits=16, gptq_groupsize=-1, gptq_act_order=False, awq_ckpt=None, awq_wbits=16, awq_groupsize=-1, enable_exllama=False, exllama_max_seq_len=4096, exllama_gpu_split=None, exllama_cache_8bit=False, enable_xft=False, xft_max_seq_len=4096, xft_dtype=None, model_names=None, conv_template='qwen-7b-chat', embed_in_truncate=False, limit_worker_concurrency=5, stream_interval=2, no_register=False, seed=None, debug=False, ssl=False)
2024-06-14 10:37:24 | INFO | model_worker | Loading the model ['Qwen-7B-QAnything'] on worker 51f7c861 ...
2024-06-14 10:37:24 | INFO | stdout | Warning: import flash_attn rotary fail, please install FlashAttention rotary to get better performance https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-14 10:37:24 | INFO | stdout | Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get better performance https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-14 10:37:24 | INFO | stdout | Warning: import flash_attn fail, please install FlashAttention https://github.com/Dao-AILab/flash-attention
2024-06-14 10:37:25 | ERROR | stderr | Loading checkpoint shards:   0%|                          | 0/2 [00:00<?, ?it/s]
2024-06-14 10:37:25 | ERROR | stderr | Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 14.96it/s]
2024-06-14 10:37:25 | ERROR | stderr | Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 14.93it/s]
2024-06-14 10:37:25 | ERROR | stderr | 
2024-06-14 10:37:27 | INFO | model_worker | Register to controller
2024-06-14 10:37:27 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m48343[0m]
2024-06-14 10:37:27 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-14 10:37:27 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-14 10:37:27 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://localhost:21002[0m (Press CTRL+C to quit)
2024-06-14 10:38:12 | INFO | model_worker | Send heart beat. Models: ['Qwen-7B-QAnything']. Semaphore: None. call_ct: 0. worker_id: 51f7c861. 
2024-06-14 10:38:12 | ERROR | model_worker | heart beat error: HTTPConnectionPool(host='localhost', port=21001): Max retries exceeded with url: /receive_heart_beat (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7369f9884210>: Failed to establish a new connection: [Errno 111] Connection refused'))
2024-06-14 10:38:17 | ERROR | model_worker | heart beat error: HTTPConnectionPool(host='localhost', port=21001): Max retries exceeded with url: /receive_heart_beat (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7369f98b2210>: Failed to establish a new connection: [Errno 111] Connection refused'))
2024-06-14 10:38:22 | ERROR | model_worker | heart beat error: HTTPConnectionPool(host='localhost', port=21001): Max retries exceeded with url: /receive_heart_beat (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7369f98b0a10>: Failed to establish a new connection: [Errno 111] Connection refused'))
2024-06-14 10:38:27 | ERROR | model_worker | heart beat error: HTTPConnectionPool(host='localhost', port=21001): Max retries exceeded with url: /receive_heart_beat (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7369f9804e50>: Failed to establish a new connection: [Errno 111] Connection refused'))
2024-06-14 10:38:28 | ERROR | stderr | [32mINFO[0m:     Shutting down
2024-06-14 10:38:28 | ERROR | stderr | [32mINFO[0m:     Waiting for application shutdown.
2024-06-14 10:38:28 | ERROR | stderr | [32mINFO[0m:     Application shutdown complete.
2024-06-14 10:38:28 | ERROR | stderr | [32mINFO[0m:     Finished server process [[36m48343[0m]
2024-06-14 10:38:28 | ERROR | stderr | Traceback (most recent call last):
2024-06-14 10:38:28 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/asyncio/runners.py", line 118, in run
2024-06-14 10:38:28 | ERROR | stderr |     return self._loop.run_until_complete(task)
2024-06-14 10:38:28 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-14 10:38:28 | ERROR | stderr |   File "uvloop/loop.pyx", line 1517, in uvloop.loop.Loop.run_until_complete
2024-06-14 10:38:28 | ERROR | stderr | asyncio.exceptions.CancelledError
2024-06-14 10:38:28 | ERROR | stderr | 
2024-06-14 10:38:28 | ERROR | stderr | During handling of the above exception, another exception occurred:
2024-06-14 10:38:28 | ERROR | stderr | 
2024-06-14 10:38:28 | ERROR | stderr | Traceback (most recent call last):
2024-06-14 10:38:28 | ERROR | stderr |   File "<frozen runpy>", line 198, in _run_module_as_main
2024-06-14 10:38:28 | ERROR | stderr |   File "<frozen runpy>", line 88, in _run_code
2024-06-14 10:38:28 | ERROR | stderr |   File "/home/c205/workspace/FastChat-main/fastchat/serve/model_worker.py", line 425, in <module>
2024-06-14 10:38:28 | ERROR | stderr |     uvicorn.run(app, host=args.host, port=args.port, log_level="info")
2024-06-14 10:38:28 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/uvicorn/main.py", line 577, in run
2024-06-14 10:38:28 | ERROR | stderr |     server.run()
2024-06-14 10:38:28 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/uvicorn/server.py", line 65, in run
2024-06-14 10:38:28 | ERROR | stderr |     return asyncio.run(self.serve(sockets=sockets))
2024-06-14 10:38:28 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-14 10:38:28 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/asyncio/runners.py", line 190, in run
2024-06-14 10:38:28 | ERROR | stderr |     return runner.run(main)
2024-06-14 10:38:28 | ERROR | stderr |            ^^^^^^^^^^^^^^^^
2024-06-14 10:38:28 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/asyncio/runners.py", line 123, in run
2024-06-14 10:38:28 | ERROR | stderr |     raise KeyboardInterrupt()
2024-06-14 10:38:28 | ERROR | stderr | KeyboardInterrupt
