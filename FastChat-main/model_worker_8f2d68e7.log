2024-06-18 23:40:31 | INFO | model_worker | args: Namespace(host='localhost', port=31002, worker_address='http://localhost:31002', controller_address='http://localhost:31001', model_path='/home/c205/workspace/models/Apollo-7B/', revision='main', device='cuda', gpus=None, num_gpus=1, max_gpu_memory=None, dtype=None, load_8bit=False, cpu_offloading=False, gptq_ckpt=None, gptq_wbits=16, gptq_groupsize=-1, gptq_act_order=False, awq_ckpt=None, awq_wbits=16, awq_groupsize=-1, enable_exllama=False, exllama_max_seq_len=4096, exllama_gpu_split=None, exllama_cache_8bit=False, enable_xft=False, xft_max_seq_len=4096, xft_dtype=None, model_names=None, conv_template=None, embed_in_truncate=False, limit_worker_concurrency=5, stream_interval=2, no_register=False, seed=None, debug=False, ssl=False)
2024-06-18 23:40:31 | INFO | model_worker | Loading the model ['Apollo-7B'] on worker 8f2d68e7 ...
2024-06-18 23:40:31 | ERROR | stderr | Loading checkpoint shards:   0%|                                                                                                                                       | 0/8 [00:00<?, ?it/s]
2024-06-18 23:40:31 | ERROR | stderr | Loading checkpoint shards:  12%|███████████████▉                                                                                                               | 1/8 [00:00<00:02,  3.30it/s]
2024-06-18 23:40:32 | ERROR | stderr | Loading checkpoint shards:  25%|███████████████████████████████▊                                                                                               | 2/8 [00:00<00:01,  3.32it/s]
2024-06-18 23:40:32 | ERROR | stderr | Loading checkpoint shards:  38%|███████████████████████████████████████████████▋                                                                               | 3/8 [00:00<00:01,  3.30it/s]
2024-06-18 23:40:32 | ERROR | stderr | Loading checkpoint shards:  50%|███████████████████████████████████████████████████████████████▌                                                               | 4/8 [00:01<00:01,  3.32it/s]
2024-06-18 23:40:33 | ERROR | stderr | Loading checkpoint shards:  62%|███████████████████████████████████████████████████████████████████████████████▍                                               | 5/8 [00:01<00:00,  3.34it/s]
2024-06-18 23:40:33 | ERROR | stderr | Loading checkpoint shards:  75%|███████████████████████████████████████████████████████████████████████████████████████████████▎                               | 6/8 [00:01<00:00,  3.31it/s]
2024-06-18 23:40:33 | ERROR | stderr | Loading checkpoint shards:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 7/8 [00:02<00:00,  3.32it/s]
2024-06-18 23:40:33 | ERROR | stderr | Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:02<00:00,  3.66it/s]
2024-06-18 23:40:33 | ERROR | stderr | 
2024-06-18 23:40:35 | INFO | model_worker | Register to controller
2024-06-18 23:40:35 | ERROR | stderr | Traceback (most recent call last):
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
2024-06-18 23:40:35 | ERROR | stderr |     sock = connection.create_connection(
2024-06-18 23:40:35 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
2024-06-18 23:40:35 | ERROR | stderr |     raise err
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
2024-06-18 23:40:35 | ERROR | stderr |     sock.connect(sa)
2024-06-18 23:40:35 | ERROR | stderr | ConnectionRefusedError: [Errno 111] Connection refused
2024-06-18 23:40:35 | ERROR | stderr | 
2024-06-18 23:40:35 | ERROR | stderr | The above exception was the direct cause of the following exception:
2024-06-18 23:40:35 | ERROR | stderr | 
2024-06-18 23:40:35 | ERROR | stderr | Traceback (most recent call last):
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/connectionpool.py", line 793, in urlopen
2024-06-18 23:40:35 | ERROR | stderr |     response = self._make_request(
2024-06-18 23:40:35 | ERROR | stderr |                ^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/connectionpool.py", line 496, in _make_request
2024-06-18 23:40:35 | ERROR | stderr |     conn.request(
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/connection.py", line 400, in request
2024-06-18 23:40:35 | ERROR | stderr |     self.endheaders()
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/http/client.py", line 1298, in endheaders
2024-06-18 23:40:35 | ERROR | stderr |     self._send_output(message_body, encode_chunked=encode_chunked)
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/http/client.py", line 1058, in _send_output
2024-06-18 23:40:35 | ERROR | stderr |     self.send(msg)
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/http/client.py", line 996, in send
2024-06-18 23:40:35 | ERROR | stderr |     self.connect()
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/connection.py", line 238, in connect
2024-06-18 23:40:35 | ERROR | stderr |     self.sock = self._new_conn()
2024-06-18 23:40:35 | ERROR | stderr |                 ^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
2024-06-18 23:40:35 | ERROR | stderr |     raise NewConnectionError(
2024-06-18 23:40:35 | ERROR | stderr | urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x71d18fae8ad0>: Failed to establish a new connection: [Errno 111] Connection refused
2024-06-18 23:40:35 | ERROR | stderr | 
2024-06-18 23:40:35 | ERROR | stderr | The above exception was the direct cause of the following exception:
2024-06-18 23:40:35 | ERROR | stderr | 
2024-06-18 23:40:35 | ERROR | stderr | Traceback (most recent call last):
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/requests/adapters.py", line 667, in send
2024-06-18 23:40:35 | ERROR | stderr |     resp = conn.urlopen(
2024-06-18 23:40:35 | ERROR | stderr |            ^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/connectionpool.py", line 847, in urlopen
2024-06-18 23:40:35 | ERROR | stderr |     retries = retries.increment(
2024-06-18 23:40:35 | ERROR | stderr |               ^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/urllib3/util/retry.py", line 515, in increment
2024-06-18 23:40:35 | ERROR | stderr |     raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2024-06-18 23:40:35 | ERROR | stderr |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr | urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=31001): Max retries exceeded with url: /register_worker (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x71d18fae8ad0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2024-06-18 23:40:35 | ERROR | stderr | 
2024-06-18 23:40:35 | ERROR | stderr | During handling of the above exception, another exception occurred:
2024-06-18 23:40:35 | ERROR | stderr | 
2024-06-18 23:40:35 | ERROR | stderr | Traceback (most recent call last):
2024-06-18 23:40:35 | ERROR | stderr |   File "<frozen runpy>", line 198, in _run_module_as_main
2024-06-18 23:40:35 | ERROR | stderr |   File "<frozen runpy>", line 88, in _run_code
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/llm_serve_workspace_dev/FastChat-main/fastchat/serve/model_worker.py", line 414, in <module>
2024-06-18 23:40:35 | ERROR | stderr |     args, worker = create_model_worker()
2024-06-18 23:40:35 | ERROR | stderr |                    ^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/llm_serve_workspace_dev/FastChat-main/fastchat/serve/model_worker.py", line 385, in create_model_worker
2024-06-18 23:40:35 | ERROR | stderr |     worker = ModelWorker(
2024-06-18 23:40:35 | ERROR | stderr |              ^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/llm_serve_workspace_dev/FastChat-main/fastchat/serve/model_worker.py", line 102, in __init__
2024-06-18 23:40:35 | ERROR | stderr |     self.init_heart_beat()
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/llm_serve_workspace_dev/FastChat-main/fastchat/serve/base_model_worker.py", line 81, in init_heart_beat
2024-06-18 23:40:35 | ERROR | stderr |     self.register_to_controller()
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/llm_serve_workspace_dev/FastChat-main/fastchat/serve/base_model_worker.py", line 99, in register_to_controller
2024-06-18 23:40:35 | ERROR | stderr |     r = requests.post(url, json=data)
2024-06-18 23:40:35 | ERROR | stderr |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/requests/api.py", line 115, in post
2024-06-18 23:40:35 | ERROR | stderr |     return request("post", url, data=data, json=json, **kwargs)
2024-06-18 23:40:35 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/requests/api.py", line 59, in request
2024-06-18 23:40:35 | ERROR | stderr |     return session.request(method=method, url=url, **kwargs)
2024-06-18 23:40:35 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
2024-06-18 23:40:35 | ERROR | stderr |     resp = self.send(prep, **send_kwargs)
2024-06-18 23:40:35 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
2024-06-18 23:40:35 | ERROR | stderr |     r = adapter.send(request, **kwargs)
2024-06-18 23:40:35 | ERROR | stderr |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-18 23:40:35 | ERROR | stderr |   File "/home/c205/anaconda3/envs/fastchat/lib/python3.11/site-packages/requests/adapters.py", line 700, in send
2024-06-18 23:40:35 | ERROR | stderr |     raise ConnectionError(e, request=request)
2024-06-18 23:40:35 | ERROR | stderr | requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=31001): Max retries exceeded with url: /register_worker (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x71d18fae8ad0>: Failed to establish a new connection: [Errno 111] Connection refused'))
